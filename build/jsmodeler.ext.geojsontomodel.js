/* JSModeler 0.42 - http://www.github.com/kovacsv/JSModeler */ 'use strict';JSM.ConvertGeoJsonToModel=function(k,u,v){function n(b,e){return JSM.SphericalToCartesian(b+0.005*b,(90-e.y)*JSM.DegRad,e.x*JSM.DegRad)}function r(b){b=parseInt(b/5,10);0===b&&(b=1);return b}function w(b,e,a,g,c){function d(a,b,e,c){function f(a,b,e){var c=[],d,g;for(d=0;d<b.length;d++)g=b[d],c.push(JSM.AddVertexToBody(a,g.x,g.y,g.z));e?(b=c.slice(0),b.reverse(),JSM.AddPolygonToBody(a,b)):JSM.AddPolygonToBody(a,c);return c}function g(a,b,e){var c=b.length,d,f,h,k,l;for(d=0;d<c;d++)f=
b[d],h=b[JSM.NextIndex(d,c)],k=e[d],l=e[JSM.NextIndex(d,c)],JSM.AddPolygonToBody(a,[f,h,l,k])}var d=[],h=[],k,l,m;for(k=0;k<b.VertexCount();k++){l=b.GetVertex(k);m=n(e,l);if(0<d.length){if(d[d.length-1].IsEqualWithEps(m,0.001))continue;if(k==b.VertexCount()-1&&d[0].IsEqualWithEps(m,0.001))continue}d.push(m);JSM.IsZero(c)||h.push(n(e-c,l))}3<=d.length&&(b=f(a,d,!0),0!==h.length&&(h=f(a,h,!1),g(a,b,h)))}var f=g.GetBoundingBox(),h=r(f.max.x-f.min.x),f=r(f.max.y-f.min.y);g=JSM.SegmentPolygon2D(g,h,f);
for(h=0;h<g.length;h++)d(b,g[h],e,a);b.SetPolygonsMaterialIndex(c)}function s(b,e,a,g){var c=new JSM.Body;l.AddBody(c);var d=new JSM.ContourPolygon2D,f,h,k,m;for(f=0;f<a.length;f++){d.AddContour();k=a[f];for(h=0;h<k.length-1;h++)m=JSM.CoordFromArray2D(k[h]),d.AddVertexCoord(m)}d.GetOrientation()!=JSM.Orientation.Clockwise&&d.ReverseVertices();a=JSM.ConvertContourPolygonToPolygon2D(d);w(c,b,e,a,g)}function x(b,e,a){if(!a.type||"Feature"!=a.type||!a.geometry||!a.geometry.type||!a.geometry.coordinates)return!1;
var g=JSM.RandomInt(0,16777215),c=new JSM.Material({ambient:g,diffuse:g,singleSided:!0}),g=l.AddMaterial(c);if("Point"==a.geometry.type)c.pointSize=10,e=a.geometry.coordinates,null===m&&(m=new JSM.Body,l.AddBody(m)),a=JSM.CoordFromArray2D(e),e=m,b=n(b,a),b=JSM.AddVertexToBody(e,b.x,b.y,b.z),b=JSM.AddPointToBody(e,b),e.GetPoint(b).SetMaterialIndex(g);else if("LineString"==a.geometry.type){e=a.geometry.coordinates;null===p&&(p=new JSM.Body,l.AddBody(p));var c=JSM.CoordFromArray2D(e[0]),d=JSM.CoordFromArray2D(e[1]);
e=p;a=new JSM.Sector2D(c,d);var c=c.DistanceTo(d),c=r(c),c=JSM.GetSectorSegmentation2D(a,c),d=e.LineCount(),f;for(a=0;a<c.length;a++)f=n(b,c[a]),f=JSM.AddVertexToBody(e,f.x,f.y,f.z),0<a&&JSM.AddLineToBody(e,f-1,f);for(a=d;a<e.LineCount();a++)b=e.GetLine(a),b.SetMaterialIndex(g)}else if("Polygon"==a.geometry.type)s(b,e,a.geometry.coordinates,g);else if("MultiPolygon"==a.geometry.type){a=a.geometry.coordinates;for(c=0;c<a.length;c++)s(b,e,a[c],g)}}if(!k.type||"FeatureCollection"!=k.type||!k.features)return null;
var l=new JSM.Model,m=null,p=null,q,t;for(q=0;q<k.features.length;q++)t=k.features[q],x(u,v,t);return l};
